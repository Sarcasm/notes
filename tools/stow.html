
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>GNU Stow &#8212; Sarcasm notebook</title>
    <link rel="stylesheet" href="../_static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="To do list" href="../todolist.html" />
    <link rel="prev" title="Tools" href="index.html" /> 
  </head><body>
      <div class="header" role="banner"><h1 class="heading"><a href="../index.html">
          <span>Sarcasm notebook</span></a></h1>
        <h2 class="heading"><span>GNU Stow</span></h2>
      </div>
      <div class="topnav" role="navigation" aria-label="top navigation">
      
        <p>
        «&#160;&#160;<a href="index.html">Tools</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="../index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="../todolist.html">To do list</a>&#160;&#160;»
        </p>

      </div>
      <div class="content">
        
        
  <div class="section" id="gnu-stow">
<h1>GNU Stow<a class="headerlink" href="#gnu-stow" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#introduction" id="id2">Introduction</a></li>
<li><a class="reference internal" href="#filesystem-layout" id="id3">Filesystem layout</a></li>
<li><a class="reference internal" href="#general-cooking-recommendations" id="id4">General cooking recommendations</a><ul>
<li><a class="reference internal" href="#cmake" id="id5">CMake</a></li>
<li><a class="reference internal" href="#gnu-build-system" id="id6">GNU Build System</a></li>
<li><a class="reference internal" href="#troubleshooting" id="id7">Troubleshooting</a></li>
</ul>
</li>
<li><a class="reference internal" href="#recipes" id="id8">Recipes</a><ul>
<li><a class="reference internal" href="#ag" id="id9">ag</a></li>
<li><a class="reference internal" href="#emacs" id="id10">emacs</a></li>
<li><a class="reference internal" href="#git" id="id11">git</a></li>
<li><a class="reference internal" href="#mu4e" id="id12">mu4e</a></li>
<li><a class="reference internal" href="#repo" id="id13">repo</a></li>
<li><a class="reference internal" href="#sourceweb" id="id14">sourceweb</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="introduction">
<h2><a class="toc-backref" href="#id2">Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>I use <a class="reference external" href="https://www.gnu.org/software/stow">GNU Stow</a> to install locally the latest version
of a handful of open source projects I care about.</p>
<p>I also use it to manage my dotfiles:</p>
<ul class="simple">
<li><a class="reference external" href="https://github.com/Sarcasm/dotfiles">https://github.com/Sarcasm/dotfiles</a></li>
</ul>
<p>This page is a memo about the usage I make of the tool.</p>
</div>
<div class="section" id="filesystem-layout">
<h2><a class="toc-backref" href="#id3">Filesystem layout</a><a class="headerlink" href="#filesystem-layout" title="Permalink to this headline">¶</a></h2>
<p>I install my packages in <code class="docutils literal notranslate"><span class="pre">~/pkg/stow/&lt;package[-version]&gt;</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">~/pkg/bin</span></code> is added to the <code class="docutils literal notranslate"><span class="pre">PATH</span></code>,
it precedes the system binaries’ search paths.</p>
<p><code class="docutils literal notranslate"><span class="pre">~/.profile</span></code> excerpt:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># User&#39;s Stow packages</span>
<span class="k">if</span> <span class="p">[</span> <span class="o">-</span><span class="n">d</span> <span class="s2">&quot;$HOME/pkg/bin&quot;</span> <span class="p">];</span> <span class="n">then</span>
    <span class="n">PATH</span><span class="o">=</span><span class="s2">&quot;$HOME/pkg/bin:$PATH&quot;</span>
<span class="n">fi</span>
</pre></div>
</div>
</div>
<div class="section" id="general-cooking-recommendations">
<h2><a class="toc-backref" href="#id4">General cooking recommendations</a><a class="headerlink" href="#general-cooking-recommendations" title="Permalink to this headline">¶</a></h2>
<p>The official recommendations are available in the manual:</p>
<ul class="simple">
<li><a class="reference external" href="https://www.gnu.org/software/stow/manual/html_node/Compile_002dtime-vs-Install_002dtime.html">https://www.gnu.org/software/stow/manual/html_node/Compile_002dtime-vs-Install_002dtime.html</a></li>
</ul>
<p>This link also explains why it is necessary sometimes
to make the package believe it is installed to <code class="docutils literal notranslate"><span class="pre">~/pkg</span></code>
and not <code class="docutils literal notranslate"><span class="pre">~/pkg/stow/&lt;package&gt;</span></code>.</p>
<div class="section" id="cmake">
<h3><a class="toc-backref" href="#id5">CMake</a><a class="headerlink" href="#cmake" title="Permalink to this headline">¶</a></h3>
<p>Generic recipe:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>cmake -G Ninja -DCMAKE_INSTALL_PREFIX=$HOME/pkg/stow/&lt;package&gt; &lt;args...&gt;
ninja
ninja install
cd ~/pkg/stow
stow &lt;package&gt;
</pre></div>
</div>
</div>
<div class="section" id="gnu-build-system">
<h3><a class="toc-backref" href="#id6">GNU Build System</a><a class="headerlink" href="#gnu-build-system" title="Permalink to this headline">¶</a></h3>
<p>Generic recipe:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>configure --prefix=$HOME/pkg &lt;args...&gt;
make
make install prefix=$HOME/pkg/stow/&lt;package&gt;
cd ~/pkg/stow
stow &lt;package&gt;
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference external" href="https://www.gnu.org/software/stow/manual/stow.html#Other-FSF-Software">https://www.gnu.org/software/stow/manual/stow.html#Other-FSF-Software</a></li>
</ul>
</div>
</div>
<div class="section" id="troubleshooting">
<h3><a class="toc-backref" href="#id7">Troubleshooting</a><a class="headerlink" href="#troubleshooting" title="Permalink to this headline">¶</a></h3>
<p>Some packages do not only add new files,
but sometimes update some files.</p>
<p>GNU Info for example, has an index file in <code class="docutils literal notranslate"><span class="pre">share/info/dir</span></code>.</p>
<p>Emacs and mu4e conflicts on this, example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ stow emacs-25.1-rc2
WARNING! stowing emacs-25.1-rc2 would cause conflicts:
  * existing target is stowed to a different package: share/info/dir =&gt; ../../stow/mu/share/info/dir
All operations aborted.
$
</pre></div>
</div>
<p>To get rid of the issue:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ cat &lt;&lt;&#39;EOF&#39; &gt; .stowrc
--ignore=share/info/dir
EOF
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference external" href="https://www.gnu.org/software/stow/manual/stow.html#Perl-and-Perl-5-Modules">https://www.gnu.org/software/stow/manual/stow.html#Perl-and-Perl-5-Modules</a></li>
<li><code class="docutils literal notranslate"><span class="pre">perllocal.pod</span></code> example:
<a class="reference external" href="https://www.gnu.org/software/stow/manual/stow.html#Resource-Files">https://www.gnu.org/software/stow/manual/stow.html#Resource-Files</a></li>
</ul>
</div>
</div>
</div>
<div class="section" id="recipes">
<h2><a class="toc-backref" href="#id8">Recipes</a><a class="headerlink" href="#recipes" title="Permalink to this headline">¶</a></h2>
<div class="section" id="ag">
<h3><a class="toc-backref" href="#id9">ag</a><a class="headerlink" href="#ag" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><a class="reference external" href="https://github.com/ggreer/the_silver_searcher">https://github.com/ggreer/the_silver_searcher</a></li>
</ul>
<p>Import public key (<a class="reference external" href="http://geoff.greer.fm/ag/">http://geoff.greer.fm/ag/</a>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gpg</span> <span class="o">--</span><span class="kn">import</span> <span class="nn">ggreer_gpg_key.asc</span>
</pre></div>
</div>
<p>Debian prerequisites:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">automake</span> <span class="n">pkg</span><span class="o">-</span><span class="n">config</span> <span class="n">libpcre3</span><span class="o">-</span><span class="n">dev</span> <span class="n">zlib1g</span><span class="o">-</span><span class="n">dev</span> <span class="n">liblzma</span><span class="o">-</span><span class="n">dev</span>
</pre></div>
</div>
<p>Recipe:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>gpg --verify the_silver_searcher-0.32.0.tar.gz.asc
tar xaf the_silver_searcher-0.32.0.tar.gz
./configure --prefix=$HOME/pkg
make
make install prefix=$HOME/pkg/stow/ag-0.32.0
cd ~/pkg/stow/
stow ag-0.32.0
</pre></div>
</div>
</div>
<div class="section" id="emacs">
<h3><a class="toc-backref" href="#id10">emacs</a><a class="headerlink" href="#emacs" title="Permalink to this headline">¶</a></h3>
<p>Download: <a class="reference external" href="https://www.gnu.org/software/emacs/download.html">https://www.gnu.org/software/emacs/download.html</a></p>
<p>I don’t think the instructions from the manual are still relevant,
it seems they were written for Emacs 19.31,
but it might be a good idea to check if that changed:</p>
<ul>
<li><p class="first"><a class="reference external" href="https://www.gnu.org/software/stow/manual/stow.html#GNU-Emacs">https://www.gnu.org/software/stow/manual/stow.html#GNU-Emacs</a></p>
<p>Since the 24.5 release,
tarballs are signed with the GPG key from Nicolas Petton <code class="docutils literal notranslate"><span class="pre">7C207910</span></code>,
fingerpint <code class="docutils literal notranslate"><span class="pre">28D3</span> <span class="pre">BED8</span> <span class="pre">51FD</span> <span class="pre">F3AB</span> <span class="pre">57FE</span> <span class="pre">F93C</span> <span class="pre">2335</span> <span class="pre">87A4</span> <span class="pre">7C20</span> <span class="pre">7910</span></code>,
which can be found in the GNU keyring.</p>
<p>– <a class="reference external" href="https://www.gnu.org/software/emacs/download.html">https://www.gnu.org/software/emacs/download.html</a></p>
</li>
</ul>
<p>Get GPG key:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gpg</span> <span class="o">--</span><span class="n">keyserver</span> <span class="n">hkp</span><span class="p">:</span><span class="o">//</span><span class="n">keys</span><span class="o">.</span><span class="n">gnupg</span><span class="o">.</span><span class="n">net</span> <span class="o">--</span><span class="n">recv</span><span class="o">-</span><span class="n">keys</span> <span class="mi">7</span><span class="n">C207910</span>
</pre></div>
</div>
<p>Recipe:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>gpg --verify emacs-25.1-rc2.tar.xz.sig
unxz emacs-25.1-rc2.tar.xz
tar xaf emacs-25.1-rc2.tar
mkdir emacs-25.1-build
cd emacs-25.1-build
# install necessary dependencies (e.g: apt-get install build-dep emacs24)
# enable module support,
# xwidget (requires libwebkitgtk-3.0-dev ubuntu, webkitgtk arch)
../emacs-25.1/configure --with-modules --with-xwidgets --prefix=$HOME/pkg/
make -j9
make prefix=$HOME/pkg/stow/emacs-25.1-rc2 install
cd ~/pkg/stow
stow emacs-25.1-rc2
</pre></div>
</div>
</div>
<div class="section" id="git">
<h3><a class="toc-backref" href="#id11">git</a><a class="headerlink" href="#git" title="Permalink to this headline">¶</a></h3>
<p>Download: <a class="reference external" href="https://www.kernel.org/pub/software/scm/git/">https://www.kernel.org/pub/software/scm/git/</a></p>
<p>Build instructions: <a class="reference external" href="https://git-scm.com/book/en/v2/Getting-Started-Installing-Git#Installing-from-Source">https://git-scm.com/book/en/v2/Getting-Started-Installing-Git#Installing-from-Source</a></p>
<p>Recipe:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>gpg --keyserver hkp://keys.gnupg.net --recv-keys 96AFE6CB
unxz git-2.9.2.tar.xz
gpg --verify git-2.9.2.tar.sign
tar xaf git-2.9.2.tar
cd git-2.9.2
# install necessary dependencies (zlib, ssl, ...), e.g: using apt-get build-dep git
make configure
./configure --prefix=$HOME/pkg/stow/git-2.9.2
make all doc info -j9
make install install-doc install-info
cd ~/pkg/stow
stow git-2.9.2
</pre></div>
</div>
</div>
<div class="section" id="mu4e">
<h3><a class="toc-backref" href="#id12">mu4e</a><a class="headerlink" href="#mu4e" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><a class="reference external" href="http://www.djcbsoftware.nl/code/mu/mu4e/Installation.html#Installation">http://www.djcbsoftware.nl/code/mu/mu4e/Installation.html#Installation</a></li>
</ul>
<p>Recipe:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>git clone git://github.com/djcb/mu.git
env CC=clang CXX=clang++ autoreconf -i
env CC=clang CXX=clang++ ./configure --prefix=$HOME/pkg
make -j9
make install prefix=$HOME/pkg/stow/mu
cd ~/pkg/stow
stow mu
</pre></div>
</div>
<p>Emacs Configuration:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">add</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="nb">list</span> <span class="s1">&#39;load-path &quot;~/pkg/share/emacs/site-lisp/mu4e&quot;)</span>
</pre></div>
</div>
</div>
<div class="section" id="repo">
<h3><a class="toc-backref" href="#id13">repo</a><a class="headerlink" href="#repo" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><a class="reference external" href="https://source.android.com/source/downloading.html">https://source.android.com/source/downloading.html</a></li>
</ul>
<p>Recipe:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mkdir</span> <span class="o">-</span><span class="n">p</span> <span class="o">~/</span><span class="n">pkg</span><span class="o">/</span><span class="n">stow</span><span class="o">/</span><span class="n">repo</span><span class="o">/</span><span class="nb">bin</span>
<span class="n">wget</span> <span class="s1">&#39;https://storage.googleapis.com/git-repo-downloads/repo&#39;</span> <span class="o">-</span><span class="n">O</span> <span class="o">~/</span><span class="n">pkg</span><span class="o">/</span><span class="n">stow</span><span class="o">/</span><span class="n">repo</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">repo</span>
<span class="n">chmod</span> <span class="n">a</span><span class="o">+</span><span class="n">x</span> <span class="o">~/</span><span class="n">pkg</span><span class="o">/</span><span class="n">stow</span><span class="o">/</span><span class="n">repo</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">repo</span>
<span class="n">cd</span> <span class="o">~/</span><span class="n">pkg</span><span class="o">/</span><span class="n">stow</span>
<span class="n">stow</span> <span class="n">repo</span>
</pre></div>
</div>
</div>
<div class="section" id="sourceweb">
<h3><a class="toc-backref" href="#id14">sourceweb</a><a class="headerlink" href="#sourceweb" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><a class="reference external" href="https://github.com/rprichard/sourceweb">https://github.com/rprichard/sourceweb</a></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">install</span> <span class="pre">prefix=&lt;path&gt;</span></code> is not satisfied like,
however it is not an issue for this program
to be installed in the <code class="docutils literal notranslate"><span class="pre">~/pkg/stow/&lt;package&gt;</span></code> directory.</p>
<p>Recipe:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>./configure --prefix=$HOME/pkg/stow/sourceweb
make
make install
cd ~/pkg/stow
stow sourceweb
</pre></div>
</div>
</div>
</div>
</div>


      </div>
      <div class="bottomnav" role="navigation" aria-label="bottom navigation">
      
        <p>
        «&#160;&#160;<a href="index.html">Tools</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="../index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="../todolist.html">To do list</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2016, Guillaume Papin.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.5.
    </div>
  </body>
</html>